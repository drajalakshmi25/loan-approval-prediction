# -*- coding: utf-8 -*-
"""Untitled3.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JzwLmjv1vnLQF7_5G-IeOS3p_1uyg09e

Upload Dataset
"""

from google.colab import files
uploaded = files.upload()

"""Import Required Libraries"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

"""Load the Dataset"""

df = pd.read_csv("Loan-Approval-Prediction.csv")
df.head()

"""Understand the Dataset"""

df.shape
df.info()
df.describe()

"""Check Missing Values"""

df.isnull().sum()

"""Handle Missing Values"""

from sklearn.preprocessing import LabelEncoder

le = LabelEncoder()
for col in df.select_dtypes(include='object').columns:
    df[col] = le.fit_transform(df[col])
df.head()

"""Exploratory Data Analysis (EDA)"""

sns.countplot(x='Loan_Status', data=df)
plt.show()
sns.countplot(x='Education', hue='Loan_Status', data=df)
plt.show()

"""Convert Categorical Data to Numerical (Label Encoding)"""

from sklearn.preprocessing import LabelEncoder

le = LabelEncoder()

cols = ['Gender','Married','Dependents','Education',
        'Self_Employed','Property_Area','Loan_Status']

for col in cols:
    df[col] = le.fit_transform(df[col])

# OUTPUT SHOW
df.head()

"""Split Dataset into Features and Target"""

X = df.drop('Loan_Status', axis=1)
y = df['Loan_Status']

# OUTPUT SHOW
print("Features (X) shape:", X.shape)
print("Target (y) shape:", y.shape)

X.head(), y.head()

"""Split Data into Training and Testing Sets"""

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# OUTPUT SHOW
print("X_train shape:", X_train.shape)
print("X_test shape:", X_test.shape)
print("y_train shape:", y_train.shape)
print("y_test shape:", y_test.shape)

"""Train the Machine Learning Model (Logistic Regression)"""

df_encoded = df.copy()

from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()

cat_cols = df_encoded.select_dtypes(include='object').columns

for col in cat_cols:
    df_encoded[col] = le.fit_transform(df_encoded[col])

df_encoded.head()

"""Make Predictions"""

y_pred = model.predict(X_test)

# OUTPUT SHOW
y_pred[:10]

"""Evaluate Model Performance"""

from sklearn.metrics import accuracy_score, confusion_matrix, classification_report

print("Accuracy:", accuracy_score(y_test, y_pred))
print("----------------------------------------------------------------")
print("Confusion Matrix:\n", confusion_matrix(y_test, y_pred))
print("----------------------------------------------------------------")
print("Classification Report:\n", classification_report(y_test, y_pred))

"""Visualize the Confusion Matrix"""

sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='d')
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.show()